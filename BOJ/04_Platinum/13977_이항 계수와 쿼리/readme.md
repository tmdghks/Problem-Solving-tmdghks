# [PLATINUM V] BOJ 13977 - 이항 계수와 쿼리

[문제 링크](https://boj.kr/1654)

### 분류

수학 (Mathematics), 정수론(Number Theory), 조합론 (Combinatorics), 분할 정복을 이용한 거듭제곱 (Power by Divide and Conquer), 모듈로 곱셈 역원 (Modulo Inverse), 페르마의 소정리 (Fermat's Little Theorem)

### 풀이

순진하게 4,000,000*4,000,000의 DP를 떠올린다면, 공간복잡도, 시간복잡도 모두에서 문제가 생긴다. 그렇기 때문에 1 <= N <= 4,000,000 팩토리얼에 대한 모듈로를 모두 연산한 뒤 4,000,000! (mod 1,000,000,007)의 모듈로 역원을 구한뒤 1! ~ 4,000,000!의 모듈로 역원을 모두 저장한다. 이 과정의 시간 복잡도는 O(n + logp)이므로 시간 안에 해결할 수 있다.  
또한, M개의 조합에 대해서 O(1)의 시간복잡도로 조합 값을 계산할 수 있으므로, O(M)의 시간복잡도가 든다.  
위 방식으로 해결하면 시간 안에 문제를 해결할 수 있다.